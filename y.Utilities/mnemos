#!/usr/bin/env bash
# Resolve repository root even when this script is copied outside the repo.
SCRIPT_PATH="$(readlink -f "$0")"
SCRIPT_DIR="$(dirname "$SCRIPT_PATH")"

PY="$SCRIPT_DIR/y.Utilities/yz/AGENT_tools/o.mnemos.py"
if [ ! -f "$PY" ]; then
    # Use MNEMOS_ROOT if provided, otherwise try git from the working directory
    if [ -n "$MNEMOS_ROOT" ] && [ -f "$MNEMOS_ROOT/y.Utilities/yz/AGENT_tools/o.mnemos.py" ]; then
        PY="$MNEMOS_ROOT/y.Utilities/yz/AGENT_tools/o.mnemos.py"
    else
        ROOT="$(git -C "$PWD" rev-parse --show-toplevel 2>/dev/null)"
        if [ -n "$ROOT" ] && [ -f "$ROOT/y.Utilities/yz/AGENT_tools/o.mnemos.py" ]; then
            PY="$ROOT/y.Utilities/yz/AGENT_tools/o.mnemos.py"
        fi
    fi
fi

python "$PY" "$@"
